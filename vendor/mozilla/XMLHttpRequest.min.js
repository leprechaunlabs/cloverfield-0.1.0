/**
 * Minified by jsDelivr using UglifyJS v3.1.10.
 * Original file: /npm/xmlhttprequest@1.8.0/lib/XMLHttpRequest.js
 * 
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
var Url=require("url"),spawn=require("child_process").spawn,fs=require("fs");exports.XMLHttpRequest=function(){"use strict";var e,t,s=this,r=require("http"),n=require("https"),o={},a=!1,i={"User-Agent":"node-XMLHttpRequest",Accept:"*/*"},h={},d={},u=["accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","content-transfer-encoding","cookie","cookie2","date","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","via"],c=["TRACE","TRACK","CONNECT"],f=!1,l=!1,p={};this.UNSENT=0,this.OPENED=1,this.HEADERS_RECEIVED=2,this.LOADING=3,this.DONE=4,this.readyState=this.UNSENT,this.onreadystatechange=null,this.responseText="",this.responseXML="",this.status=null,this.statusText=null,this.withCredentials=!1;this.open=function(e,t,s,r,n){if(this.abort(),l=!1,!function(e){return e&&-1===c.indexOf(e)}(e))throw new Error("SecurityError: Request method not allowed");o={method:e,url:t.toString(),async:"boolean"!=typeof s||s,user:r||null,password:n||null},E(this.OPENED)},this.setDisableHeaderCheck=function(e){a=e},this.setRequestHeader=function(e,t){if(this.readyState!==this.OPENED)throw new Error("INVALID_STATE_ERR: setRequestHeader can only be called when state is OPEN");if(function(e){return a||e&&-1===u.indexOf(e.toLowerCase())}(e)){if(f)throw new Error("INVALID_STATE_ERR: send flag is true");e=d[e.toLowerCase()]||e,d[e.toLowerCase()]=e,h[e]=h[e]?h[e]+", "+t:t}else console.warn('Refused to set unsafe header "'+e+'"')},this.getResponseHeader=function(e){return"string"==typeof e&&this.readyState>this.OPENED&&t&&t.headers&&t.headers[e.toLowerCase()]&&!l?t.headers[e.toLowerCase()]:null},this.getAllResponseHeaders=function(){if(this.readyState<this.HEADERS_RECEIVED||l)return"";var e="";for(var s in t.headers)"set-cookie"!==s&&"set-cookie2"!==s&&(e+=s+": "+t.headers[s]+"\r\n");return e.substr(0,e.length-2)},this.getRequestHeader=function(e){return"string"==typeof e&&d[e.toLowerCase()]?h[d[e.toLowerCase()]]:""},this.send=function(a){if(this.readyState!==this.OPENED)throw new Error("INVALID_STATE_ERR: connection must be opened before send() is called");if(f)throw new Error("INVALID_STATE_ERR: send has already been called");var u,c=!1,p=!1,y=Url.parse(o.url);switch(y.protocol){case"https:":c=!0;case"http:":u=y.hostname;break;case"file:":p=!0;break;case void 0:case null:case"":u="localhost";break;default:throw new Error("Protocol not supported.")}if(p){if("GET"!==o.method)throw new Error("XMLHttpRequest: Only GET method is supported");if(o.async)fs.readFile(y.pathname,"utf8",function(e,t){e?s.handleError(e):(s.status=200,s.responseText=t,E(s.DONE))});else try{this.responseText=fs.readFileSync(y.pathname,"utf8"),this.status=200,E(s.DONE)}catch(e){this.handleError(e)}}else{var S=y.port||(c?443:80),w=y.pathname+(y.search?y.search:"");for(var N in i)d[N.toLowerCase()]||(h[N]=i[N]);if(h.Host=u,c&&443===S||80===S||(h.Host+=":"+y.port),o.user){void 0===o.password&&(o.password="");var v=new Buffer(o.user+":"+o.password);h.Authorization="Basic "+v.toString("base64")}"GET"===o.method||"HEAD"===o.method?a=null:a?(h["Content-Length"]=Buffer.isBuffer(a)?a.length:Buffer.byteLength(a),h["Content-Type"]||(h["Content-Type"]="text/plain;charset=UTF-8")):"POST"===o.method&&(h["Content-Length"]=0);var T={host:u,port:S,path:w,method:o.method,headers:h,agent:!1,withCredentials:s.withCredentials};if(l=!1,o.async){var g=c?n.request:r.request;f=!0,s.dispatchEvent("readystatechange");var C=function(e){s.handleError(e)};e=g(T,function r(n){if(301!==(t=n).statusCode&&302!==t.statusCode&&303!==t.statusCode&&307!==t.statusCode)t.setEncoding("utf8"),E(s.HEADERS_RECEIVED),s.status=t.statusCode,t.on("data",function(e){e&&(s.responseText+=e),f&&E(s.LOADING)}),t.on("end",function(){f&&(E(s.DONE),f=!1)}),t.on("error",function(e){s.handleError(e)});else{o.url=t.headers.location;var a=Url.parse(o.url);u=a.hostname;var i={hostname:a.hostname,port:a.port,path:a.path,method:303===t.statusCode?"GET":o.method,headers:h,withCredentials:s.withCredentials};(e=g(i,r).on("error",C)).end()}}).on("error",C),a&&e.write(a),e.end(),s.dispatchEvent("loadstart")}else{var D=".node-xmlhttprequest-content-"+process.pid,O=".node-xmlhttprequest-sync-"+process.pid;fs.writeFileSync(O,"","utf8");for(var R="var http = require('http'), https = require('https'), fs = require('fs');var doRequest = http"+(c?"s":"")+".request;var options = "+JSON.stringify(T)+";var responseText = '';var req = doRequest(options, function(response) {response.setEncoding('utf8');response.on('data', function(chunk) {  responseText += chunk;});response.on('end', function() {fs.writeFileSync('"+D+"', JSON.stringify({err: null, data: {statusCode: response.statusCode, headers: response.headers, text: responseText}}), 'utf8');fs.unlinkSync('"+O+"');});response.on('error', function(error) {fs.writeFileSync('"+D+"', JSON.stringify({err: error}), 'utf8');fs.unlinkSync('"+O+"');});}).on('error', function(error) {fs.writeFileSync('"+D+"', JSON.stringify({err: error}), 'utf8');fs.unlinkSync('"+O+"');});"+(a?"req.write('"+JSON.stringify(a).slice(1,-1).replace(/'/g,"\\'")+"');":"")+"req.end();",q=spawn(process.argv[0],["-e",R]);fs.existsSync(O););var L=JSON.parse(fs.readFileSync(D,"utf8"));q.stdin.end(),fs.unlinkSync(D),L.err?s.handleError(L.err):(t=L.data,s.status=L.data.statusCode,s.responseText=L.data.text,E(s.DONE))}}},this.handleError=function(e){this.status=0,this.statusText=e,this.responseText=e.stack,l=!0,E(this.DONE),this.dispatchEvent("error")},this.abort=function(){e&&(e.abort(),e=null),h=i,this.status=0,this.responseText="",this.responseXML="",l=!0,this.readyState===this.UNSENT||this.readyState===this.OPENED&&!f||this.readyState===this.DONE||(f=!1,E(this.DONE)),this.readyState=this.UNSENT,this.dispatchEvent("abort")},this.addEventListener=function(e,t){e in p||(p[e]=[]),p[e].push(t)},this.removeEventListener=function(e,t){e in p&&(p[e]=p[e].filter(function(e){return e!==t}))},this.dispatchEvent=function(e){if("function"==typeof s["on"+e]&&s["on"+e](),e in p)for(var t=0,r=p[e].length;t<r;t++)p[e][t].call(s)};var E=function(e){e!=s.LOADING&&s.readyState===e||(s.readyState=e,(o.async||s.readyState<s.OPENED||s.readyState===s.DONE)&&s.dispatchEvent("readystatechange"),s.readyState!==s.DONE||l||(s.dispatchEvent("load"),s.dispatchEvent("loadend")))}};
//# sourceMappingURL=/sm/1040782f0e532c67bb07c8f4a3a4ab5ae484d454f4624c1c8f28ac51bc205415.map